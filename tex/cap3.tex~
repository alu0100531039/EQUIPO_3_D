%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Chapter 3: Procedimiento experimental 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
El experimento realizado consiste en aproximar la distribución de los aminoácidos en las proteínas mediante la Poisson. (Ejemplo 1 del primer capítulo)
Además, una vez obtenidos los datos, se podrán comparar con experimentos realizados antes de la aparición del modelo de Poisson y con los datos reales observados.

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Descripción de los experimentos}
\label{3:sec:1} 

Teniendo en cuenta la descripción dada en el Ejemplo 1, Capítulo 1 (Motivación y objetivos), se ha diseñado un modelo preparado para aplicar la distribución de Poisson a un número entero  'n', que será introducido por el usuario, y que representa el número de dipéptidos (unión de dos aminoácidos, estructuras principales de las proteínas).
Además, la función de distribución consta de un parámetro 'lambda' que es constante pero que hay que calcular en base a los datos dados del experimento.\\
En este caso,  se toma una muestra con la que podrían formarse 177 dipéptidos de un total de 400 combinaciones diferentes (por ser dipéptidos -2- y haber 20 proteínas posibles: 20x20=400), por tanto, nuestro parámetro será la cantidad constante 177/400 = 0.442 . \\
Una vez introducido el número 'n', el algoritmo calcula la probabilidad de que exista una casilla con 'n' dipéptidos, entendiendo por casilla  el total (400).
Posteriormente, muestra una tabla en la que aparecen, desde 0 hasta 'n' el número de dipéptidos, su probabilidad según la distribución y la frecuencia total (400x'n').
\\
\\
\\

El algoritmo es el siguiente:
\\
\begin{verbatim}
#!/usr/bin/python
#!encoding: UTF-8

import sys
import math

def calcular_poi(n):
  lam = 0.4425
  f_i=1 #factorial
  for i in range(n+1):
    if i==0:
      f_i=f_i
    else:
      f_i=f_i*i;
  ex = math.exp(-lam)
  ln = lam**n
  v1 = ex * ln
  valor_poi = v1 / f_i
  return (valor_poi)
    
#programa principal

argumentos = sys.argv[1:]

if (len(argumentos) == 1 ):
  n = int (argumentos[0]);
else:
  print 'Introduzca el número de  dipéptidos(0<n<10):'
  n = int (raw_input());
    
if (n>0):

  lista = [] #para indicar que es una variable de tipo lista
  for i in range (n+1):

    valor = calcular_poi(i)
    lista.append (valor) #para añadir valores a la lista

  print "numero de dipeptidos por casilla\tdistribucion de Poisson (f(x))\t400xf(x)"
    
  for i in range (n+1):
    print "%d\t\t\t\t\t%1.10f\t\t\t%1.10f" % (i, lista[i],400*lista[i])
      
   
else:
  print 'el número de dipeptidos debe ser mayor que 0'


\end{verbatim}

Este estudio se ha hecho para el número de dipéptidos 'n' = 8 , con lo que se solicita al usuario que el número esté en el intervalo [0,10].
No obstante, el algoritmo es válido para números naturales mayores.

En el Apéndice 1 se especifica el nombre del archivo de extensión Python que debe ejecutarse para realizar el experimento.

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Descripción del material}
\label{3:sec:2}

Para la implementación del algoritmo, como ya se ha mencionado en varias ocasiones, se ha utilizado Python.
\\
\\

Las características de la máquina desde la que se ha realizado el informe son las siguientes:
\\
\\


('default', 'Feb 27 2014 20:00:17')\\
Linux-3.2.0-61-generic-i686-with-Ubuntu-12.04-precise\\
('Linux', 'PROA', '3.2.0-61-generic', '#93-Ubuntu SMP Fri May 2 21:33:33 UTC 2014', 'i686', 'i686')\\
2.7.3\\
Intel(R) Celeron(R) M CPU        520  @ 1.60GHz\\
GenuineIntel\\
1595.908 Hz\\
1024 KB\\
\\
\\

Además, se ha estudiado el tiempo que tarda la máquina en ejecutar el algoritmo principal en función del dato introducido. Ver Figura \ref {fig:1}
\\
\\
\begin{figure}[!th]
\begin{center}
\includegraphics[width=0.75\textwidth]{images/tiempo_ejecucion.eps}
\caption{Tiempos de ejecucion del algoritmo}
\label{fig:1}
\end{center}
\end{figure}

\\
\\
El Apéndice 1 incluye también los nombres de los archivos con los algoritmos implementados para obtener los datos de la máquina y los tiempos de ejecución.


%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Resultados obtenidos}
\label{3:sec:3}

Las siguientes tablas y gráficos representan los resultados obtenidos en el experimento y además una comparación con resultados reales observados y experimentos anteriores a la aplicación de la distribución de Poisson. 
Véase el Cuadro \ref {tabla2} y la Figura \ref {fig:2}

%------------------------------------------------------------------------------
\begin{figure}[!th]
\begin{center}
\includegraphics[width=0.75\textwidth]{images/comparacion.eps}
\caption{Comparacion Poisson-C Diamante-C Triangulo}
\label{fig:2}
\end{center}
\end{figure}
%------------------------------------------------------------------------------


%------------------------------------------------------------------------------
\input{tables/tablas.tex}
%------------------------------------------------------------------------------

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Análisis de los resultados}
\label{3:sec:4}

Haciendo un análisis detallado de los datos que muestran las tablas, puede observarse que la distribución de Poisson es la que describe en mejor medida el experimento. 
\\
Es claro que al comparar las gráficas, la función que representa la distribución de Poisson se acerca mucho más a los datos reales observados.
\\
Sin embargo, los experimentos anteriores (Codigo Diamante y Codigo Triangulo) son algo menos acertados.
\\
Se infiere de la observación que a medida que aumenta el número de dipéptidos, es menos probable encontrar casillas que los contengan, es decir, existen muchas más casillas con una cantidad pequeña de dipéptidos que casillas con grandes cantidades. De hecho, se ha elegido como 'n' = 8 porque a partir de esta cantidad, la probabilidad de que las casillas esté vacías es casi total. 
\\
Este hecho podría ser útil en diferentes campos de la biología o la medicina, entre otros.

